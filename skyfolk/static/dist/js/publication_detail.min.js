function AJAX_delete_publication(a){var b=$(a).attr("id").split("-")[1],c=$(a).data("id"),d={userprofile_id:c,publication_id:b,csrfmiddlewaretoken:csrftoken};$.ajax({url:"/publication/delete/",type:"POST",dataType:"json",data:d,success:function(b){1==b?$(a).fadeToggle("fast"):swal({title:"Fail",customClass:"default-div",text:"Failed to delete publish.",type:"error"})},error:function(a,b){}})}function AJAX_add_like(a,b,c){var d;0==c.localeCompare("publication")?d=$(a).attr("id").split("-")[1]:0==c.localeCompare("timeline")&&(d=$(a).attr("data-publication"));var e=$(a).attr("data-id"),f={userprofile_id:e,publication_id:d,csrfmiddlewaretoken:csrftoken};$.ajax({url:"/publication/add_like/",type:"POST",dataType:"json",data:f,success:function(a){var c=a.response,d=a.statuslike,e=$(b).find("#like-value"),f=e.text();if(1==c)if(!f||Math.floor(f)==f&&$.isNumeric(f)){if(1==d)$(b).css("color","#f06292"),f++;else if(2==d)$(b).css("color","#555"),f--;else if(3==d){$(b).css("color","#f06292");var g=$(b).prev(),h=g.find(".hate-value"),i=h.text();i--,i<=0?h.text(""):h.text(i),$(g).css("color","#555"),f++}f<=0?e.text(""):e.text(f)}else 1==d&&$(b).css("color","#f06292"),2==d&&$(b).css("color","#555");else swal({title:":-(",text:"¡No puedes dar me gusta a este comentario!",timer:4e3,customClass:"default-div",animation:"slide-from-bottom",showConfirmButton:!1,type:"error"})},error:function(a,b){}})}function AJAX_add_hate(a,b,c){var d;0==c.localeCompare("publication")?d=$(a).attr("id").split("-")[1]:0==c.localeCompare("timeline")&&(d=$(a).attr("data-publication"));var e=$(a).attr("id"),f={userprofile_id:e,publication_id:d,csrfmiddlewaretoken:csrftoken};$.ajax({url:"/publication/add_hate/",type:"POST",dataType:"json",data:f,success:function(a){var c=a.response,d=a.statuslike,e=$(b).find(".hate-value"),f=e.text();if(1==c)if(!f||Math.floor(f)==f&&$.isNumeric(f)){if(1===d)$(b).css("color","#ba68c8"),f++;else if(2===d)$(b).css("color","#555"),f--;else if(3===d){$(b).css("color","#ba68c8"),f++;var g=$(b).next(),h=g.find("#like-value"),i=h.text();i--,i<=0?h.text(""):h.text(i),$(g).css("color","#555")}f<=0?e.text(""):e.text(f)}else 1===d?$(b).css("color","#ba68c8"):2===d&&$(b).css("color","#555");else swal({title:":-(",text:"¡No puedes dar no me gusta a este comentario!",timer:4e3,customClass:"default-div",animation:"slide-from-bottom",showConfirmButton:!1,type:"error"})},error:function(a,b){}})}function AJAX_add_timeline(a,b,c){var d={publication_id:a,content:c,csrfmiddlewaretoken:csrftoken},e=$(b).find(".fa-quote-right"),f=$(e).text();f=f.replace(/ /g,""),$.ajax({url:"/publication/share/publication/",type:"POST",dataType:"json",data:d,success:function(a){if(1==a.response){var c=a.status;1==c?((!f||Math.floor(f)==f&&$.isNumeric(f))&&(f++,f>0?$(e).text(" "+f):$(e).text(" ")),$(b).attr("id","remove_from_skyline"),$(b).css("color","#bbdefb"),$("#share-publication-wrapper").hide()):2==c&&((!f||Math.floor(f)==f&&$.isNumeric(f))&&(f--,f>0?$(e).text(" "+f):$(e).text(" ")),$(b).attr("id","add_to_skyline"),$(b).css("color","#555"))}else swal({title:"Fail",customClass:"default-div",text:"Failed to add to timeline.",type:"error"})},error:function(a,b){}})}var max_height_comment=60;$(document).ready(function(){var a=$("#publication-thread"),b=$("#share-publication-wrapper");$(a).find(".wrapper").each(function(){var a=$(this).find(".wrp-comment"),b=$(this).find(".show-more a");$(a).height()>max_height_comment&&($(b).show(),$(a).css("height","2.6em"))}),$(".wrapper").on("click",".show-more a",function(){var a=$(this),b=a.parent().prev("div.comment").find(".wrp-comment"),c=a.text().toUpperCase();return"+ MOSTRAR MÁS"===c?(c="- Mostrar menos",b.css("height","auto")):(c="+ Mostrar más",b.css("height","2.6em")),a.text(c),!1}),$(a).on("click","#options-comments .fa-reply",function(){var a=$(this).attr("id").slice(6);$("#"+a).slideToggle("fast")}),$(a).on("click","button.enviar",function(a){a.preventDefault();var b=$(this).attr("id").split("-")[1],c=$(this).parent();$(c).find("input[name=parent]").val(b);var d=$(c).find("input[name=author]").val(),e=$(c).find("input[name=board_owner]").val(),f=[d,e,b];AJAX_submit_publication(c,"reply",f)}),$(document).on("click","#options-comments #add_to_skyline",function(){var a=this;$(b).attr("data-id",$(a).attr("data-id")),$(b).show()}),$(b).find("#share_publication_form").on("submit",function(a){a.preventDefault();var c=$(b).find("#shared_comment_content").val(),d=$(b).attr("data-id");AJAX_add_timeline(d,$("#pub-"+d).find(".add-timeline").first(),c)}),$("#close_share_publication").click(function(){$(b).hide()}),$(document).on("click","#options-comments #remove_from_skyline",function(){var a=$(this).closest(".wrapper"),b=this;AJAX_add_timeline($(a).attr("id").split("-")[1],b,null)}),$(a).on("click","#options-comments #like-heart",function(){AJAX_add_like($(this).closest(".wrapper"),this,"publication")}),$(a).on("click","#options-comments #fa-hate",function(){AJAX_add_hate($(this).closest(".wrapper"),this,"publication")}),$(a).on("click","#options-comments .fa-trash",function(){var a=$(this).closest(".wrapper");swal({title:"Are you sure?",text:"You will not be able to recover this publication!",type:"warning",animation:"slide-from-top",showConfirmButton:!0,showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No God, please no!",closeOnConfirm:!0},function(b){b&&AJAX_delete_publication(a)})})});