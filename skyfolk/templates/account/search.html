{% extends 'account/base_search.html' %}
{% comment %}
  Template para las busquedas
{% endcomment %}
{% load app_filters %}
{% load avatar_tags %}
{% load humanize %}
{% block title %} <title>Búsqueda en Skyfolk.</title> {% endblock %}
{% block include_files %}
    <link rel="stylesheet" href="{{STATIC_URL}}css/gallery.css" onload="if(media!='all')media='all'"> <!-- Estilos para la galeria de fotos -->
    <style>
.notice-item {
    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
    border-radius: 7px;
    margin-top: 5%;
    overflow: hidden;
}
.notice-item .img {
    border-radius: 7px;
    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
}
.notice-item .img img {
    width: 100%;
    height: 100%;
}
.notice-item .contenido {
    margin-top: 2.5%;
    margin-bottom: 1.5%;
    word-wrap: break-word;
    line-height: 1.5rem;
}
.notice-item .author {
    display: block;
    margin-top: 1.25%;
}
.notice-item .author a {
    text-decoration: none;
    color: #1e88e5;
    font-weight: 600;
    margin-right: 2%;
}
.notice-item .author i {
    color: gray;
}
.notice-item  .pub-date {
    margin-top: 2%;
    display: block;
}
    </style>
{% endblock %}
{% block content %}
<div class="container">
            <div class="row">
              <div class="col l12 m12 s12">
                <ul class="query-options">
                    <li class="list-vertical"><a href="/search/">Destacados</a></li>
                    <li class="list-vertical"><a href="/search/1">Cuentas</a></li>
                    <li class="list-vertical"><a href="/search/2">Publicaciones</a></li>
                    <li class="list-vertical"><a href="/search/3">Imágenes</a></li>
                    <li class="list-vertical">Videos</li>
                    <li class="list-vertical">Más opciones <i class="fa fa-caret-down" aria-hidden="true"></i>
                        <div id="dropdown-search" class="dropdown-options">
                            <ul class="dropdown-ul">
                                <li>Todo</li>
                                <li>Nuevo</li>
                                <li>De todos</li>
                                <li>Personas que sigues</li>
                                <li>Personas que te siguen</li>
                                <li id="search-advanced">Búsqueda avanzada</li>
                            </ul>
                        </div>
                    </li>
                </ul>
              </div>
          </div>
            {% if resultSearch|length == 0 and resultMessages|length == 0 and result_media|length == 0 %}
            <div class="row">
              <div class="col s12">
                   <div class="noelements-search" id="search-noelements">
                     <h5 class="">Sin resultados :-(</h5>
                     <i class="not-query">No se obtuvo ningún resultado para:
                       {% for word in words %}
                        {{ word }}
                       {% endfor %}
                    </i>
                  </div>
              </div>
            </div>
          {% endif %}
          <div class="row">
          {% if resultSearch|length != 0 %}
          <h2 class="account-search">Cuentas</h2>
              {% for item in resultSearch %}
                    <div class="col l3 m5 s12">
                        <div class="personal-card">
                            <div class="col s12">
                                <div class="header">
                                    {% if item.profile.backImage %}
                                    <img class="back-profile-user" src="{{ item.profile.backImage.url }}">
                                       {% else %}
                                       <img class="back-profile-user" src="{{ STATIC_URL }}img/nuevo_back.png">
                                    {% endif %}
                                    <i class="fa fa-user fa-2x like-him">
                                    </i>
                                    <div class="bg-user">
                                        <div onclick="location.href='/profile/{{ item.username }}'" class="profile-user-bg">{% avatar item %}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="col s12">
                                <div class="name-friend">
                                <p>{{ item.username }}</p><br>
                                    <p>{{ item.first_name }} {{item.last_name}}</p>
                                </div>
                            </div>
                        </div>
                    </div>
        {% endfor %}
            {% endif %}
           </div>
    <div class="row">
        {% if resultMessages|length != 0 %}
            <h2 class="messages-search">Publicaciones</h2>
            <div class="row">
            {% for pub in resultMessages %}
                {% if user.username|check_follow:pub.author.username and not user.username|check_blocked:pub.author.username %} {% comment 'Check privacity' %} Comprobamos la privacidad del autor del mensaje {% endcomment %}
                    <div class="col l3 m6 s12">
                        <div class="notice-item">
                            <div class="row">
                            <div class="col s3 img">
                                {% avatar pub.author.username %}
                            </div>
                         <div class="col l8 m7 s8 author">
                            <a href="/profile/{{ pub.author.username }}">@{{ pub.author.username }}</a>
                            <i>{{ pub.author.first_name }} {{ pub.author.last_name }}</i>
                            <i class="pub-date">{{ pub.created|naturaltime }}</i>
                         </div>
                        <div class="col l9 m9 s9 contenido">
                            <p class="flow-text">{{pub.content|safe}}</p>
                        </div>
                        </div>
                        </div>
                    </div>
                    {% endif %}
            {% endfor %}
            </div>
        {% endif %}
    </div>
        <div class="row">
        {% if result_media|length != 0 %}
            <h2 class="messages-search">Media</h2>
            {% for photo in result_media %}
                {% if user.username|check_follow:photo.owner.username and not user.username|check_blocked:photo.owner.username %} {% comment 'Check privacity' %} Comprobamos la privacidad del autor del mensaje {% endcomment %}
                        <div class="col l2 m12 s12 image-div">
                            <div class="container-image">
                                <div class="principal-content">
                                    {% if photo.tags.all %}
                                        <div class="tags-content">
                                        <form method="post" action="{% url "photologue:collection-list" photo.pk photo.owner %}">{% csrf_token %}
                                            {% for tag in photo.tags.all %}
                                                <blockquote>{{ tag.name }}</blockquote>
                                            {% endfor %}
                                        <input data-id="{{ photo.pk }}" type="submit" hidden>
                                        </form>
                                        </div>
                                    {% endif %}
                                    <img src="{{ photo.image.url }}" alt="{{ photo.title }}" title="{{ photo.title }}" onclick="location.href='{{ photo.get_absolute_url }}'">
                                </div>
                                <div class="col s12 legend-content">
                                    <div class="legend-user-image">
                                        {% avatar photo.owner.username %}
                                    </div>
                                    <div class="col l8 m8 s8 legend-user-data">
                                        <a href="/profile/{{ photo.owner.username }}">@{{ photo.owner.username }}</a>
                                        <i class="photo-title truncate">{{ photo.title }}</i>
                                        <i class="truncate photo-date"><i class="fa fa-clock-o" aria-hidden="true"></i> {{ photo.date_added|naturaltime }}</i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
            {% endfor %}
        {% endif %}
    </div>
    <script async src="{{STATIC_URL}}js/search.js"></script>
    <script async src="{{STATIC_URL}}js/photo_gallery.js" type="text/javascript"></script>
{% endblock %}
</div>
