function AJAX_likeprofile(a){"noabort"==a?$.ajax({type:"POST",url:"/like_profile/",data:{slug:$("#profileId").html(),csrfmiddlewaretoken:csrftoken},dataType:"json",success:function(a){var b=$("#likes").find("strong");"like"==a?($("#ilike_profile").css("color","#ec407a"),$(b).html(parseInt($(b).html())+1)):"nolike"==a?($("#ilike_profile").css("color","#46494c"),$(b).html()>0&&$(b).html(parseInt($(b).html())-1)):"blocked"==a?swal({title:"Vaya... algo no está bien.",customClass:"default-div",text:"Si quieres dar un like, antes debes desbloquear este perfil.",timer:4e3,showConfirmButton:!0,type:"error"}):console.log("...")},error:function(a,b){}}):"anonymous"==a&&swal({title:"¡Ups!",text:"Debe estar registrado",customClass:"default-div"})}function add_loaded_publication(a,b,c,d){var e=JSON.parse(b);if(void 0===e||e.length<=0)return void(d&&$(c).remove());var f,g=$("#pub-"+a);if(g.length&&!d){var h=$(g).find(".children").first();h.length||(h=$(g).find(".wrapper-reply").after('<ul class="children"></ul>'));var i,j="";for(i=0;i<e.length;i++)if(void 0===(f=$("pub-"+e[i].id))||!f.length){if(j='<div class="row">',j+='<div class="col s12">',e[i].level>0&&e[i].level<3?j+=' <div class="col s12 wrapper" id="pub-'+e[i].id+'" data-id="'+e[i].user_id+'" style="min-width: 98% !important;">':j+=' <div class="col s12 wrapper" id="pub-'+e[i].id+'" data-id="'+e[i].user_id+'">',j+='            <div class="box">',j+='            <span id="check-'+e[i].id+'" class="top-options zoom-pub tooltipped" data-position="bottom" data-delay="50" data-tooltip="Ver conversación completa"><i class="fa fa-plus-square-o" aria-hidden="true"></i></span>',e[i].user_id!=e[i].author_id||1!=e[i].event_type&&3!=e[i].event_type||(j+='            <span data-id="'+e[i].id+'" id="edit-comment-content" class="top-options edit-comment tooltipped" data-position="bottom" data-delay="50" data-tooltip="Editar comentario"><i class="fa fa-pencil" aria-hidden="true"></i></span>'),j+='<div class="row">',j+='                <div class="articulo col s12">',j+='<div class="row">',e[i].user_id==e[i].author_id?j+='      <div class="image col l1 m2 s2" style="box-shadow: 0 1px 5px rgba(129, 199, 132, 1);">':j+='      <div class="image col l1 m2 s2">',j+='        <div class="usr-img img-responsive"><img src="'+e[i].author_avatar+'" alt="'+e[i].author_username+'" width="120" height="120"></div>',j+="      </div>",j+='<div class="col l10 m12 s9">',j+='                  <h2 class="h22"><a href="/profile/'+e[i].author_username+'" >@'+e[i].author_username+"</a>",e[i].parent&&(j+='<span class="chip">',j+='<img src="'+e[i].parent_avatar+'" alt="'+e[i].parent_author+'">',j+='<i class="fa fa-reply"></i> <a href="/profile/'+e[i].parent_author+'">@'+e[i].parent_author+"</a>",j+="</span>"),j+="</h2>",j+='                    <p id="pub-created" class="blue-text text-darken-2">'+e[i].created+"</p><br>",j+='<div class="row publication-content">',j+='                  <div class="parrafo comment">',j+='                      <div class="wrp-comment">'+e[i].content+"</div>",j+="                  </div>",j+='                    <div class="show-more" id="show-comment-'+e[i].id+'">',j+='                        <a href="#">+ Mostrar más</a>',j+="                    </div>",j+="                    </div>",e[i].extra_content&&(j+='<div class="card small">',j+='<div class="card-image">',e[i].extra_content_image?j+='<img src="'+e[i].extra_content_image+'">':j+='<img src="/static/dist/img/nuevo_back.png">',j+='<span class="card-title white-text">'+e[i].extra_content_title+"</span>",j+="</div>",j+='<div class="card-content">',j+="<p>"+e[i].extra_content_description+"</p>",j+="</div>",j+='<div class="card-action">',j+='<a href="'+e[i].extra_content_url+'">Ver</a>',j+="</div></div>"),void 0!==e[i].images&&e[i].images.length>0){j+='<div class="row images">';for(var k=0;k<e[i].images.length;k++)j+='<div class="col s4 z-depth-2">',j+='<img class="responsive-img" src="/media/'+e[i].images[k].image+'" alt="Imagen de: '+e[i].author_username+'" title="Imagen de: '+e[i].author_username+'">',j+="                    </div>";j+="                    </div>"}if(void 0!==e[i].videos&&e[i].videos.length>0){j+='<div class="row videos">';for(var l=0;l<e[i].videos.length;l++)j+='<div class="col s4 z-depth-2 center">',j+='<video class="responsive-video" controls loop><source src="/media/'+e[i].videos[l].video+'" type="video/mp4"></video>',j+="                    </div>";j+="                    </div>"}j+="                    </div>",j+="                    </div>",j+="                    </div>",j+="                    </div>",j+='<div class="row">',j+='<div class="divider"></div>',j+='                <div class="options_comentarios" id="options-comments">',j+='                    <ul class="opciones">',e[i].user_id!=e[i].board_owner_id&&e[i].user_id!=e[i].author_id||(j+='                             <li class="trash-comment" title="Borrar comentario"><i class="fa fa-trash"></i></li>'),e[i].user_id!=e[i].author_id&&(j+='                            <li title="No me gusta" class="hate-comment" id="fa-hate">',j+='                                <i class="fa fa-angle-down" aria-hidden="true"></i>',j+='                                <i class="fa hate-value">'+(e[i].hates>0?e[i].hates:"")+"</i>",j+="                            </li>",j+='                        <li id="like-heart" title="¡Me gusta!" class="like-comment"><i class="fa fa-angle-up" aria-hidden="true"></i><i id="like-value" class="fa">'+(e[i].likes>0?e[i].likes:"")+"</i></li>"),j+='                       <li title="Añadir a mi skyline" data-id="'+e[i].id+'" class="add-timeline" id="add_to_skyline"><i class="fa fa-quote-right" aria-hidden="true"> '+(e[i].shares>0?e[i].shares:"")+"</i></li>",j+='                       <li title="Responder" class="reply-comment"><i class="fa fa-reply" id="reply-caja-comentario-'+e[i].id+'"></i></li>',j+="                    </ul>",j+="                </div>",j+="                </div>",j+="    </div>",e[i].user_id==e[i].author_id&&(j+='<div data-user-id="'+e[i].author_id+'" id="author-controls-'+e[i].id+'" class="author-controls">',j+='<div class="row">',j+='<div class="col s12">',j+='<form method="post" accept-charset="utf-8">',j+='<input type="hidden" name="csrfmiddlewaretoken" value="'+e[i].token+'">',j+='<div class="row">',j+='<div class="input-field col s12">',j+='<i class="material-icons prefix">create</i>',j+='<textarea class="materialize-textarea" placeholder="Escribe el contenido del nuevo mensaje" id="id_caption-'+e[i].id+'" cols="40" maxlength="500" name="content" rows="10" required="required" style="height: 10.9969px;"></textarea>',j+='<label for="id_caption-'+e[i].id+'">Editar comentario</label></div>',j+='<div class="row">',j+='<button data-id="'+e[i].id+'" class="waves-effect waves-light btn blue darken-1 right edit-comment-btn" type="button" id="submit_edit_publication">Editar<i class="material-icons right">mode_edit</i></button>',j+="</div></div></form></div></div></div>"),j+='<div class="wrapper-reply">',j+='<div class="hidden" id="caja-comentario-'+e[i].id+'">',j+='<form class="reply-form" action="" method="post">',j+='<input type="hidden" name="csrfmiddlewaretoken" value="'+e[i].token+'">',j+='<input id="id_author" name="author" type="hidden" value="'+e[i].user_id+'">',j+='<input id="id_board_owner" name="board_owner" type="hidden" value="'+e[i].board_owner_id+'">',j+='<input id="id_parent" name="parent" type="hidden">',j+='<div class="row">',j+='<div class="col s12">',j+='<div class="row">',j+='<div class="input-field col s12">',j+='<textarea class="materialize-textarea message-reply" id="message-reply-'+e[i].id+'" cols="40" maxlength="500" name="content" placeholder="Responder a @'+e[i].author_username+'" rows="10" required=""></textarea>',j+='<label for="message-reply-'+e[i].id+'">Escribe tu mensaje aqui...</label>',j+="</div>",j+='<div class="file-field input-field col s12">',j+='<div class="btn">',j+="<span>Imágenes</span>",j+='<input id="id_image_reply" name="image" type="file" multiple>',j+="</div>",j+='<div class="file-path-wrapper">',j+='<input class="file-path validate" type="text" placeholder="Upload one or more files">',j+="</div></div></div></div></div>",j+='<button type="button" id="reply-'+e[i].id+'" class="waves-effect waves-light btn right blue enviar">Enviar<i class="material-icons right">send</i></button>',j+="</form></div></div>",e[i].descendants>0&&(j+='<div class="row">',j+='<div class="col s12">',j+='<a class="waves-effect waves-light btn-large blue darken-1 white-text center" href="#" id="load_more_publications" data-id="'+e[i].id+'"><i class=" material-icons left">expand_more</i>Cargar comentarios ('+e[i].descendants+")</a>",j+="<div>",j+='<div class="progress" id="load_publications_descendants" style="display: none;">',j+='<div class="indeterminate blue darken-1"></div></div>',j+="</div></div></div>"),j+="    </div></div></div>",$(j).appendTo(h).hide().fadeIn(250)}var m=$(c).find("#child_count"),n=parseInt($(m).html(),10)-e.length;n>0?$(m).html(n):$(c).remove()}else if(d){for(i=0;i<e.length;i++)if(f=$("pub-"+e[i].id),!f.length){if(j='<div class="row">',j+='<div class="col s12">',e[i].level>0&&e[i].level<3?j+=' <div class="col s12 wrapper" id="pub-'+e[i].id+'" data-id="'+e[i].user_id+'" style="min-width: 98% !important;">':j+=' <div class="col s12 wrapper" id="pub-'+e[i].id+'" data-id="'+e[i].user_id+'">',j+='            <div class="box">',j+='            <span id="check-'+e[i].id+'" class="top-options zoom-pub tooltipped" data-position="bottom" data-delay="50" data-tooltip="Ver conversación completa"><i class="fa fa-plus-square-o" aria-hidden="true"></i></span>',e[i].user_id!=e[i].author_id||1!=e[i].event_type&&3!=e[i].event_type||(j+='            <span data-id="'+e[i].id+'" id="edit-comment-content" class="top-options edit-comment tooltipped" data-position="bottom" data-delay="50" data-tooltip="Editar comentario"><i class="fa fa-pencil" aria-hidden="true"></i></span>'),j+='<div class="row">',j+='                <div class="articulo col s12">',j+='<div class="row">',e[i].user_id==e[i].author_id?j+='      <div class="image col l1 m2 s2" style="box-shadow: 0 1px 5px rgba(129, 199, 132, 1);">':j+='      <div class="image col l1 m2 s2">',j+='        <div class="usr-img img-responsive"><img src="'+e[i].author_avatar+'" alt="'+e[i].author_username+'" width="120" height="120"></div>',j+="      </div>",j+='<div class="col l10 m12 s9">',j+='                  <h2 class="h22"><a href="/profile/'+e[i].author_username+'" >@'+e[i].author_username+"</a>",e[i].parent&&(j+='<span class="chip">',j+='<img src="'+e[i].parent_avatar+'" alt="'+e[i].parent_author+'">',j+='<i class="fa fa-reply"></i> <a href="/profile/'+e[i].parent_author+'">@'+e[i].parent_author+"</a>",j+="</span>"),j+="</h2>",j+='                    <p id="pub-created" class="blue-text text-darken-2">'+e[i].created+"</p><br>",j+='<div class="row publication-content">',j+='                  <div class="parrafo comment">',j+='                      <div class="wrp-comment">'+e[i].content+"</div>",j+="                  </div>",j+='                    <div class="show-more" id="show-comment-'+e[i].id+'">',j+='                        <a href="#">+ Mostrar más</a>',j+="                    </div>",j+="                    </div>",e[i].extra_content&&(j+='<div class="card small">',j+='<div class="card-image">',e[i].extra_content_image?j+='<img src="'+e[i].extra_content_image+'">':j+='<img src="/static/dist/img/nuevo_back.png">',j+='<span class="card-title white-text">'+e[i].extra_content_title+"</span>",j+="</div>",j+='<div class="card-content">',j+="<p>"+e[i].extra_content_description+"</p>",j+="</div>",j+='<div class="card-action">',j+='<a href="'+e[i].extra_content_url+'">Ver</a>',j+="</div></div>"),void 0!==e[i].images&&e[i].images.length>0){j+='<div class="row images">';for(var k=0;k<e[i].images.length;k++)j+='<div class="col s4 z-depth-2">',j+='<img class="responsive-img" src="/media/'+e[i].images[k].image+'" alt="Imagen de: '+e[i].author_username+'" title="Imagen de: '+e[i].author_username+'">',j+="                    </div>";j+="                    </div>"}if(void 0!==e[i].videos&&e[i].videos.length>0){j+='<div class="row videos">';for(var l=0;l<e[i].videos.length;l++)j+='<div class="col s4 z-depth-2 center">',j+='<video class="responsive-video" controls loop><source src="/media/'+e[i].videos[l].video+'" type="video/mp4"></video>',j+="                    </div>";j+="                    </div>"}6===e[i].event_type&&(j+="<style>.comment .fa-share {color: #1e88e5;font-style: normal;}</style>",j+='<div class="card grey lighten-5">',j+='<div class="card-content black-text">',j+='<img src="'+e[i].shared_pub_avatar+'" alt="'+e[i].shared_pub_author+'" width="70" height="70" style="box-shadow: 0 1px 5px rgba(30, 136, 229, 0.15);"><br>',j+='<span class="card-title"><a href="/profile/'+e[i].shared_pub_author+'">@'+e[i].author_username+"</a>",j+='<i class="blue-text text-darken-2"> '+e[i].shared_created+"</i></span>",j+="<p>"+e[i].shared_pub_content+"</p>",e[i].shared_image&&(j+='<br><div class="row">',j+='<div class="col s7">',j+='<img class="responsive-img" src="'+e[i].shared_image+'" alt="Imagen de: '+e[i].shared_pub_author+'" title="Imagen de: '+e[i].shared_pub_author+'">',j+="</div></div>"),void 0!==e[i].shared_pub_extra_url&&e[i].shared_pub_extra_url&&(j+='<div class="card small">',j+='<div class="card-image">',e[i].shared_pub_extra_image?j+='<img src="'+e[i].shared_pub_extra_image+'">':j+='<img src="/static/dist/img/nuevo_back.png">',j+='<span class="card-title white-text">'+e[i].shared_pub_extra_title+"</span></div>",j+='<div class="card-content">',j+="<p>"+e[i].shared_pub_extra_description+"</p></div>",j+='<div class="card-action">',j+='<a href="'+e[i].shared_pub_extra_url+'">Ver</a></div></div></div>'),j+='<div class="card-action">',j+='<a class="blue-text text-darken-2" href="/publication/'+e[i].shared_pub_id+'">Ver</a></div></div>'),j+="                    </div>",j+="                    </div>",j+="                    </div>",j+="                    </div>",j+='<div class="row">',j+='<div class="divider"></div>',j+='                <div class="options_comentarios" id="options-comments">',j+='                    <ul class="opciones">',e[i].user_id!=e[i].board_owner_id&&e[i].user_id!=e[i].author_id||(j+='                             <li class="trash-comment" title="Borrar comentario"><i class="fa fa-trash"></i></li>'),e[i].user_id!=e[i].author_id&&(j+='                            <li title="No me gusta" class="hate-comment" id="fa-hate">',j+='                                <i class="fa fa-angle-down" aria-hidden="true"></i>',j+='                                <i class="fa hate-value">'+(e[i].hates>0?e[i].hates:"")+"</i>",j+="                            </li>",j+='                        <li id="like-heart" title="¡Me gusta!" class="like-comment"><i class="fa fa-angle-up" aria-hidden="true"></i><i id="like-value" class="fa">'+(e[i].likes>0?e[i].likes:"")+"</i></li>"),j+='                       <li title="Añadir a mi skyline" data-id="'+e[i].id+'" class="add-timeline" id="add_to_skyline"><i class="fa fa-quote-right" aria-hidden="true"> '+(e[i].shares>0?e[i].shares:"")+"</i></li>",j+='                       <li title="Responder" class="reply-comment"><i class="fa fa-reply" id="reply-caja-comentario-'+e[i].id+'"></i></li>',j+="                    </ul>",j+="                </div>",j+="                </div>",j+="    </div>",e[i].user_id==e[i].author_id&&(j+='<div data-user-id="'+e[i].author_id+'" id="author-controls-'+e[i].id+'" class="author-controls">',j+='<div class="row">',j+='<div class="col s12">',j+='<form method="post" accept-charset="utf-8">',j+='<input type="hidden" name="csrfmiddlewaretoken" value="'+e[i].token+'">',j+='<div class="row">',j+='<div class="input-field col s12">',j+='<i class="material-icons prefix">create</i>',j+='<textarea class="materialize-textarea" placeholder="Escribe el contenido del nuevo mensaje" id="id_caption-'+e[i].id+'" cols="40" maxlength="500" name="content" rows="10" required="required" style="height: 10.9969px;"></textarea>',j+='<label for="id_caption-'+e[i].id+'">Editar comentario</label></div>',j+='<div class="row">',j+='<button data-id="'+e[i].id+'" class="waves-effect waves-light btn blue darken-1 right edit-comment-btn" type="button" id="submit_edit_publication">Editar<i class="material-icons right">mode_edit</i></button>',j+="</div></div></form></div></div></div>"),j+='<div class="wrapper-reply">',j+='<div class="hidden" id="caja-comentario-'+e[i].id+'">',j+='<form class="reply-form" action="" method="post">',j+='<input type="hidden" name="csrfmiddlewaretoken" value="'+e[i].token+'">',j+='<input id="id_author" name="author" type="hidden" value="'+e[i].user_id+'">',j+='<input id="id_board_owner" name="board_owner" type="hidden" value="'+e[i].board_owner_id+'">',j+='<input id="id_parent" name="parent" type="hidden">',j+='<div class="row">',j+='<div class="col s12">',j+='<div class="row">',j+='<div class="input-field col s12">',j+='<textarea class="materialize-textarea message-reply" id="message-reply-'+e[i].id+'" cols="40" maxlength="500" name="content" placeholder="Responder a @'+e[i].author_username+'" rows="10" required=""></textarea>',j+='<label for="message-reply-'+e[i].id+'">Escribe tu mensaje aqui...</label>',j+="</div>",j+='<div class="file-field input-field col s12">',j+='<div class="btn">',j+="<span>Imágenes</span>",j+='<input id="id_image_reply" name="image" type="file" multiple>',j+="</div>",j+='<div class="file-path-wrapper">',j+='<input class="file-path validate" type="text" placeholder="Upload one or more files">',j+="</div></div></div></div></div>",j+='<button type="button" id="reply-'+e[i].id+'" class="waves-effect waves-light btn right blue enviar">Enviar<i class="material-icons right">send</i></button>',j+="</form></div></div>",e[i].descendants>0&&(j+='<div class="row">',j+='<div class="col s12">',j+='<a class="waves-effect waves-light btn-large blue darken-1 white-text center" href="#" id="load_more_publications" data-id="'+e[i].id+'"><i class=" material-icons left">expand_more</i>Cargar comentarios ('+e[i].descendants+")</a>",j+="<div>",j+='<div class="progress" id="load_publications_descendants" style="display: none;">',j+='<div class="indeterminate blue darken-1"></div></div>',j+="</div></div></div>"),j+="    </div></div></div>",$("#tab-comentarios").find("#loader_skyline").before(j)}void 0===e||e.length<=20?$(c).remove():$(c).attr("data-id",e[e.length-1].id)}}function AJAX_load_publications(a,b,c,d){var e={id:a,last_pub:c,csrfmiddlewaretoken:csrftoken};$.ajax({url:"/publication/load/more/",type:"POST",dataType:"json",data:e,success:function(b){1==b.response?add_loaded_publication(a,b.pubs,d,!1):swal({title:"Fail",customClass:"default-div",text:"Failed to load more publications.",type:"error"})},complete:function(){$(b).fadeOut()},error:function(a,b){}})}function AJAX_load_skyline(a,b){if(void 0!==$(b)&&$(b).length){var c=$(b).attr("data-id"),d={id:c,csrfmiddlewaretoken:csrftoken};$.ajax({url:"/publication/load/skyline/",type:"POST",dataType:"json",data:d,success:function(a){1==a.response?add_loaded_publication(c,a.pubs,b,!0):swal({title:"Fail",customClass:"default-div",text:"Failed to load more publications.",type:"error"})},complete:function(){$(a).fadeOut()},error:function(a,b){}})}}function AJAX_edit_publication(a,b){var c={id:a,content:b,csrfmiddlewaretoken:csrftoken};$.ajax({url:"/publication/edit/",type:"POST",dataType:"json",data:c,success:function(b){var c=b.data;console.log(b.data),1==c?$("#author-controls-"+a).fadeToggle("fast"):swal({title:"Fail",customClass:"default-div",text:"Failed to edit publish.",type:"error"})},error:function(a,b){}})}function AJAX_delete_publication(a){var b=$(a).attr("id").split("-")[1],c=$(a).attr("data-id"),d={userprofile_id:c,publication_id:b,csrfmiddlewaretoken:csrftoken};$.ajax({url:"/publication/delete/",type:"POST",dataType:"json",data:d,success:function(b){1==b?$(a).fadeToggle("fast"):swal({title:"Fail",customClass:"default-div",text:"Failed to delete publish.",type:"error"})},error:function(a,b){}})}function AJAX_add_like(a,b,c){var d;0==c.localeCompare("publication")?d=$(a).attr("id").split("-")[1]:0==c.localeCompare("timeline")&&(d=$(a).attr("data-publication"));var e=$(a).attr("data-id"),f={userprofile_id:e,publication_id:d,csrfmiddlewaretoken:csrftoken};$.ajax({url:"/publication/add_like/",type:"POST",dataType:"json",data:f,success:function(a){var c=a.response,d=a.statuslike,e=$(b).find("#like-value"),f=e.text();if(1==c)if(!f||Math.floor(f)==f&&$.isNumeric(f)){if(1==d)$(b).css("color","#f06292"),f++;else if(2==d)$(b).css("color","#555"),f--;else if(3==d){$(b).css("color","#f06292");var g=$(b).prev(),h=g.find(".hate-value"),i=h.text();i--,i<=0?h.text(""):h.text(i),$(g).css("color","#555"),f++}f<=0?e.text(""):e.text(f)}else 1==d&&$(b).css("color","#f06292"),2==d&&$(b).css("color","#555");else swal({title:":-(",text:"¡No puedes dar me gusta a este comentario!",timer:4e3,customClass:"default-div",animation:"slide-from-bottom",showConfirmButton:!1,type:"error"})},error:function(a,b){}})}function AJAX_add_hate(a,b,c){var d;0==c.localeCompare("publication")?d=$(a).attr("id").split("-")[1]:0==c.localeCompare("timeline")&&(d=$(a).attr("data-publication"));var e=$(a).attr("id"),f={userprofile_id:e,publication_id:d,csrfmiddlewaretoken:csrftoken};$.ajax({url:"/publication/add_hate/",type:"POST",dataType:"json",data:f,success:function(a){var c=a.response,d=a.statuslike,e=$(b).find(".hate-value"),f=e.text();if(1==c)if(!f||Math.floor(f)==f&&$.isNumeric(f)){if(1===d)$(b).css("color","#ba68c8"),f++;else if(2===d)$(b).css("color","#555"),f--;else if(3===d){$(b).css("color","#ba68c8"),f++;var g=$(b).next(),h=g.find("#like-value"),i=h.text();i--,i<=0?h.text(""):h.text(i),$(g).css("color","#555")}f<=0?e.text(""):e.text(f)}else 1===d?$(b).css("color","#ba68c8"):2===d&&$(b).css("color","#555");else swal({title:":-(",text:"¡No puedes dar no me gusta a este comentario!",timer:4e3,customClass:"default-div",animation:"slide-from-bottom",showConfirmButton:!1,type:"error"})},error:function(a,b){}})}function AJAX_add_timeline(a,b,c){var d={publication_id:a,content:c,csrfmiddlewaretoken:csrftoken},e=$(b).find(".fa-quote-right"),f=$(e).text();f=f.replace(/ /g,""),$.ajax({url:"/publication/share/publication/",type:"POST",dataType:"json",data:d,success:function(a){if(1==a.response){var c=a.status;1==c?((!f||Math.floor(f)==f&&$.isNumeric(f))&&(f++,f>0?$(e).text(" "+f):$(e).text(" ")),$(b).attr("id","remove_from_skyline"),$(b).css("color","#bbdefb"),$("#share-publication-wrapper").hide()):2==c&&((!f||Math.floor(f)==f&&$.isNumeric(f))&&(f--,f>0?$(e).text(" "+f):$(e).text(" ")),$(b).attr("id","add_to_skyline"),$(b).css("color","#555"))}else swal({title:"Fail",customClass:"default-div",text:"Failed to add to timeline.",type:"error"})},error:function(a,b){}})}function AJAX_bloq_user(a){var b=$("#profileId").html();$.ajax({type:"POST",url:"/bloq_user/",data:{id_user:b,csrfmiddlewaretoken:csrftoken},dataType:"json",success:function(b){if(1==b.response){if($(a).css("color","#FF6347"),"none"==b.status||"isfollow"==b.status?$("#addfriend").replaceWith('<span class="fa fa-ban" id="bloq-user-span" title="Bloqueado" onclick="AJAX_remove_bloq();"> </span>'):"inprogress"==b.status&&$("#follow_request").replaceWith('<span class="fa fa-ban" id="bloq-user-span" title="Bloqueado" onclick="AJAX_remove_bloq();"> </span>'),"liked"==b.haslike){$("#ilike_profile").css("color","#46494c");var c=document.getElementById("likes");$(c).find("strong").html()>0&&$(c).find("strong").html(parseInt($(c).find("strong").html())-1)}}else swal({title:"Tenemos un problema...",customClass:"default-div",text:"Hubo un problema con su petición.",timer:4e3,showConfirmButton:!0})},error:function(a,b){}})}function AJAX_remove_bloq(){$.ajax({type:"POST",url:"/remove_blocked/",data:{slug:$("#profileId").html(),csrfmiddlewaretoken:csrftoken},dataType:"json",success:function(a){1==a?($("#bloq-user-span").replaceWith('<span id="addfriend" class="fa fa-plus" title="Seguir" style="color:#555 !important;" onclick=AJAX_requestfriend("noabort");> </span>'),$("#bloq-user").css("color","#555")):swal({title:"Tenemos un problema...",customClass:"default-div",text:"Hubo un problema con su petición.",timer:4e3,showConfirmButton:!0})},error:function(a,b){}})}var countFriendList=1,flag_reply=!1,max_height_comment=60;$(document).ready(function(){function a(a){var b=$(a).attr("id").split("-")[1];window.location.href="/publication/"+b}function b(a){var b=$(a).attr("id").split("-")[1],c=document.getElementById("expand-"+b);$(c).hide()}var c=$("#tab-comentarios"),d=$("#tab-timeline"),e=$("#tab-amigos"),f=$("#share-publication-wrapper");$(c).find(".wrapper").each(function(){var a=$(this).find(".wrp-comment"),b=$(this).find(".show-more a");$(a).height()>max_height_comment&&($(b).show(),$(a).css("height","2.6em"))}),$(c).on("click",".show-more a",function(){var a=$(this),b=a.parent().prev("div.comment").find(".wrp-comment"),c=a.text().toUpperCase();return"+ MOSTRAR MÁS"===c?(c="- Mostrar menos",b.css("height","auto")):(c="+ Mostrar más",b.css("height","2.6em")),a.text(c),!1}),$(d).find(".timeline-pub").each(function(){var a=$(this).find("#timeline-id-content"),b=a.text(),c=$(this).find(".show-more a");b=b.replace(/\s\s+/g," "),b.length<90&&$(c).css("display","none")}),$(d).on("click",".show-more a",function(){var a=$(this),b=a.parent().prev("#timeline-id-content"),c=a.text().toUpperCase();return"+ MOSTRAR MÁS"===c?(c="- Mostrar menos",b.css("height","auto")):(c="+ Mostrar más",b.css("height","2.6em")),a.text(c),!1}),$(".fa-paw").on("click",function(){$(".info-paw").show()}),$(".info-trof").on("click",function(){$(".trofeos").show()}),$(".info-groups").on("click",function(){$(".grupos").show()}),$("#close-trofeos").on("click",function(){$(".trofeos").hide()}),$("#close-grupos").on("click",function(){$(".grupos").hide()}),$("#configurationOnProfile").on("click",function(){var a=$(".ventana-pin");$(a).is(":visible")?($("html, body").removeClass("body-inConf"),$(a).fadeOut("fast")):($("html, body").addClass("body-inConf"),$(a).fadeIn("fast"))}),$(c).on("click","#options-comments .fa-reply",function(){var a=$(this).attr("id").slice(6);$("#"+a).slideToggle("fast")}),$(c).on("click","#edit-comment-content",function(){var a=$(this).attr("data-id");$("#author-controls-"+a).slideToggle("fast")}),$(c).on("click","#submit_edit_publication",function(a){a.preventDefault();var b=$(this).attr("data-id");AJAX_edit_publication(b,$(this).closest("#author-controls-"+b).find("#id_caption-"+b).val())}),$(c).on("click",".wrapper .zoom-pub",function(){a($(this).closest(".wrapper"))}),$(".cerrar_ampliado").on("click",function(){b($(this).closest(".ampliado"))}),$(c).on("click","#options-comments .fa-trash",function(){var a=$(this).closest(".wrapper");swal({title:"Are you sure?",text:"You will not be able to recover this publication!",type:"warning",animation:"slide-from-top",showConfirmButton:!0,showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",cancelButtonText:"No God, please no!",closeOnConfirm:!0},function(b){b&&AJAX_delete_publication(a)})}),$(document).on("click","#options-comments #add_to_skyline",function(){var a=this;$(f).attr("data-id",$(a).attr("data-id")),$(f).show()}),$(f).find("#share_publication_form").on("submit",function(a){a.preventDefault();var b=$(f).find("#shared_comment_content").val(),c=$(f).attr("data-id");AJAX_add_timeline(c,$("#pub-"+c).find(".add-timeline").first(),b)}),$("#close_share_publication").click(function(){$(f).hide()}),$(document).on("click","#options-comments #remove_from_skyline",function(){var a=$(this).closest(".wrapper"),b=this;AJAX_add_timeline($(a).attr("id").split("-")[1],b,null)}),$(document).on("click","#options-comments #like-heart",function(){AJAX_add_like($(this).closest(".wrapper"),this,"publication")}),$(document).on("click","#options-comments #fa-hate",function(){AJAX_add_hate($(this).closest(".wrapper"),this,"publication")}),$("#li-tab-amigos").click(function(){$(e).css({overflow:"auto"})}),$("#li-tab-comentarios").click(function(){$(c).css({overflow:"auto"})}),$("#li-tab-timeline").click(function(){$("#tab-timeline").css({overflow:"auto"})}),$("#personal-card-info").find("#bloq-user").on("click",function(){var a=document.getElementById("info-user-name-profile"),b=a.getAttribute("data-id"),c=$(this);swal({title:"Bloquear a "+b,text:b+" no podrá seguirte, enviarte mensajes ni ver tu contenido.",type:"warning",customClass:"default-div",animation:"slide-from-top",showConfirmButton:!0,showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Bloquear",cancelButtonText:"Cancelar",closeOnConfirm:!0},function(a){a&&AJAX_bloq_user(c)})}),$(this).click(function(a){var b=$("#personal-card-info");$(a.target).closest("#personal-card-info").length||$(a.target).closest(".fa-paw").length||$(b).is(":visible")&&$(b).hide()}),$(c).on("click","#load_more_publications",function(){var a=$(this).next().find("#load_publications_descendants");$(a).fadeIn();var b=$(a).closest(".row").prev(".children").find(".wrapper").last().attr("id"),c="";return void 0!==b&&b.length&&(c=b.toString().split("-")[1]),AJAX_load_publications($(this).attr("data-id"),a,c,this),!1}),$(c).on("click","#load_more_skyline",function(){var a=$(this),b=$(a).next().find("#load_publications_skyline");return $(b).fadeIn(),AJAX_load_skyline(b,a),!1})});var didScroll=!1;$(window).scroll(function(){$(window).scrollTop()==$(document).height()-$(window).height()&&(didScroll=!0)}),setInterval(function(){if(didScroll){didScroll=!1;var a=$("#load_more_skyline"),b=$(a).next().find("#load_publications_skyline");$(b).fadeIn(),AJAX_load_skyline(b,a)}},250);